\documentclass{book}

\usepackage{etex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Babel language package
%\usepackage[english,greek]{babel}
% Inputenc font encoding
%\usepackage[utf8]{inputenc}


% \usepackage{xltxtra} 
% \usepackage{xgreek} 
% \setmainfont[Mapping=tex-text]{GFS Didot} 

%\usepackage{kmath,kerkis} % The order of the packages matters; kmath changes the default text font
%\usepackage[T1]{fontenc}
\usepackage{ifxetex}
\ifxetex
    % IF XELATEX

% MINION new font
\usepackage{fontspec}
%\usepackage{mathspec}

\setmainfont[Extension=.ttf,UprightFont=*-Regular,BoldFont=*-Bold,ItalicFont=*-Italic,BoldItalicFont=*-Bold-Italic]{Minion-Pro}
\setsansfont[Extension=.ttf,UprightFont=*H,BoldFont=*HB,ItalicFont=*HI,BoldItalicFont=*HBI]{Vera}
%\usepackage{unicode-math}
%\setmathfont{Minion-Pro-Regular.ttf}
%\setmathfont[range=\mathup]{Minion-Pro-Regular.ttf}
%\setmathfont[range=\mathit]{Minion-Pro-Italic.ttf}
%\setmathfont[range=\mathbf]{Minion-Pro-Bold.ttf}
%\setmathfont[range={0222B}]{Minion-Pro-Italic.ttf}
%\setmathfontface\mathfoo{Minion-Pro-Regular.ttf}
%\setoperatorfont\mathfoo
    \usepackage{polyglossia}
    \setdefaultlanguage{greek}
    \setotherlanguage{english}
    %\RequirePackage{unicode-math}
    %\setmathfont{Latin Modern Math}
    %\newcommand{\smblkcircle}{â€¢}
\else
    % IF PDFLATEX
    %\usepackage{tgheros}
    %\renewcommand*\familydefault{\sfdefault}
    %\usepackage[eulergreek]{sansmath}
    %\sansmath
    \usepackage[T1]{fontenc}
    \usepackage[utf8]{inputenc}
    \usepackage[english,greek]{babel}
\fi


\usepackage{anyfontsize}
\newlength{\FONTmain}\setlength{\FONTmain}{9pt}
\newlength{\FONTmainbl}\setlength{\FONTmainbl}{1.2\FONTmain}
\renewcommand{\tiny}        {\fontsize{0.6\FONTmain}{0.6\FONTmainbl}\selectfont}
\renewcommand{\scriptsize}  {\fontsize{0.7\FONTmain}{0.7\FONTmainbl}\selectfont}
\renewcommand{\footnotesize}{\fontsize{0.8\FONTmain}{0.8\FONTmainbl}\selectfont}
\renewcommand{\small}       {\fontsize{0.9\FONTmain}{0.9\FONTmainbl}\selectfont}
\renewcommand{\normalsize}  {\fontsize{1.0\FONTmain}{1.0\FONTmainbl}\selectfont}
\renewcommand{\large}       {\fontsize{1.2\FONTmain}{1.2\FONTmainbl}\selectfont}
\renewcommand{\Large}       {\fontsize{1.4\FONTmain}{1.4\FONTmainbl}\selectfont}
\renewcommand{\LARGE}       {\fontsize{1.6\FONTmain}{1.6\FONTmainbl}\selectfont}
\renewcommand{\huge}        {\fontsize{1.8\FONTmain}{1.8\FONTmainbl}\selectfont}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[table,RGB]{xcolor}

\usepackage{geometry}
\geometry{a5paper,top=10mm,bottom=15mm,left=10mm,right=15mm}
\setlength{\parindent}{0pt}


%\usepackage{extsizes}
\usepackage{multicol}

%%%%% math packages %%%%%%%%%%%%%%%%%%
\usepackage[intlimits]{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{proof}
\usepackage{mathtools}

\usepackage[italicdiff]{physics}
\usepackage{siunitx}
\usepackage{xfrac}

%%%%%%% symbols packages %%%%%%%%%%%%%%
\usepackage{bm} %for use \bm instead \boldsymbol in math mode
\usepackage{dsfont}
%\usepackage{stmaryrd}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%% graphics %%%%%%%%%%%%%%%%%%%%%%%
\usepackage{graphicx}
%\usepackage{color}
%\usepackage{xypic}
%\usepackage[all]{xy}
%\usepackage{calc}

%%%%%% tables %%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{array}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{makecell}
\usepackage{minibox}
\usepackage{systeme}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{enumerate}
\usepackage{tikz}
\usepackage{fancyhdr}
%%%%% header and footer rule %%%%%%%%%
%\setlength{\headheight}{14pt}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancypagestyle{plain}{\fancyhf{}\rfoot{\thepage}}
\fancypagestyle{vangelis}{\fancyhf{}
    \fancyfootoffset[LE,RO]{10mm}
    \rfoot[]{\thepage}
    \lfoot[\thepage]{}
    \rhead[]{\tikz[remember picture,overlay]{\node[rotate=90,anchor=east] (text) at ([shift={(-5mm,-8mm)}]current page.north east) {\textcolor{Col\thechapter}{\small\strut\leftmark}};
    \fill[Col\thechapter] ([xshift={-2.5mm}]text.east) rectangle++(5mm,5mm);
    }}
    %\lhead[\textcolor{Col\thechapter}{\leftmark}]{}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[space]{grffile}


\definecolor{Col1}{HTML}{eb3b79}
\definecolor{Col2}{HTML}{9a529f}
\definecolor{Col3}{HTML}{775ba6}
\definecolor{Col4}{HTML}{5a68b0}
\definecolor{Col5}{HTML}{55a0d8}
\definecolor{Col6}{HTML}{34b0e5}
\definecolor{Col7}{HTML}{34c1d7}
\definecolor{Col8}{HTML}{65bc6a}
\definecolor{Col9}{HTML}{9acb62}
\definecolor{Col10}{HTML}{d1dd5b}
\definecolor{Col11}{HTML}{f9ec5d}
\definecolor{Col12}{HTML}{fbc82a}
\definecolor{Col13}{HTML}{faa725}
\definecolor{Col14}{HTML}{f26f47}
\definecolor{Col15}{HTML}{8e6d65}
\definecolor{Col16}{HTML}{bdbcbc}
\definecolor{Col17}{HTML}{79919d}


\everymath{\displaystyle}

\usepackage{tcolorbox}

\usepackage[explicit]{titlesec}
%%%%%% titlesec settings %%%%%%%%%%%%%
% \titleformat{ command }[ shape ]{ format }{ label }{ sep }{ before-code }[ after-code 
% \titlespacing*{ command }{ left }{ before-sep }{ after-sep }[ right-sep ]
% Chapter
\titleformat{\chapter}[block]{\huge\bfseries}{\begin{tcolorbox}[colback=Col\thechapter,left=3pt,right=3pt,top=18pt,bottom=18pt]\centering\huge\bfseries#1\end{tcolorbox}}{0pt}{\markboth{#1}}
\titlespacing*{\chapter}{0cm}{6\baselineskip}{0\baselineskip}[0ex]
% Section
\titleformat{\section}[hang]{\clearpage\pagestyle{plain}\Large\bfseries}{\begin{tcolorbox}[colback=Col\thechapter!50!white,left=1pt,right=1pt,top=2pt,bottom=2pt]\strut#1\end{tcolorbox}}{0ex}{}
\titlespacing*{\section}{0cm}{2\baselineskip}{\baselineskip}[0ex]
% Subsection
\titleformat{\subsection}[hang]{\large\bfseries\color{Col\thechapter}}{#1}{0ex}{}
\titlespacing*{\subsection}{0cm}{2\baselineskip}{\baselineskip}[0ex]
% Subsubsection
%\titleformat{\subsubsection}[hang]{\normalsize\bfseries}{#1}{0ex}{}
\titlespacing*{\subsubsection}{0cm}{\baselineskip}{\baselineskip}[0ex]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\AtBeginDocument{\pagestyle{vangelis}\normalsize\raggedright}



\newcommand{\twocolumnside}[2]{\begin{minipage}[t]{0.45\linewidth}\raggedright
#1
\end{minipage}\hfill\vrule\hfill\begin{minipage}[t]{0.45\linewidth}\raggedright
#2
\end{minipage}
}

\usepackage{calc}
\usepackage{array}
\definecolor{TabLine}{RGB}{254,254,254}
\newcommand{\TabRowHead}{\rowcolor{TabHeadRow}}
\newcommand{\TabRowHeadCor}{\cellcolor{white}}
\newcommand{\TabRowHCol}{\color{white}\bfseries\boldmath}
\newcommand{\TabCellHead}{\cellcolor{TabHeadRow}\TabRowHCol}
\newenvironment{Mytable}%
    {\begingroup\setlength{\arrayrulewidth}{2pt}\arrayrulecolor{TabLine}
    \colorlet{TabHeadRow}{Col\thechapter}
    \colorlet{TabRowOdd}{Col\thechapter!50!white}
    \colorlet{TabRowEven}{Col\thechapter!25!white}
    \rowcolors{1}{TabRowOdd}{TabRowEven}
    }%
    {\endgroup

}